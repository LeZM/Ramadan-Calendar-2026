<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horaires de Prière - Ramadan 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Crimson+Pro:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --forest: #1a3a2e;
            --sage: #4a6b5c;
            --mint: #7d9d88;
            --cream: #f4f1ea;
            --gold: #c9a961;
            --shadow: rgba(26, 58, 46, 0.15);
            --highlight: rgba(201, 169, 97, 0.25);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Crimson Pro', serif;
            background: linear-gradient(135deg, var(--forest) 0%, #0f2419 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            color: var(--cream);
            overflow-x: hidden;
        }

        .container {
            max-width: 500px;
            width: 100%;
            background: rgba(74, 107, 92, 0.12);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(201, 169, 97, 0.2);
            border-radius: 24px;
            padding: 3rem 2.5rem;
            box-shadow: 0 20px 60px var(--shadow);
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 2.5rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid rgba(201, 169, 97, 0.2);
        }

        .arabic-date {
            font-family: 'Amiri', serif;
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: 0.5rem;
            letter-spacing: 0.5px;
            animation: slideDown 0.6s ease-out 0.2s both;
        }

        .gregorian-date {
            font-size: 1.1rem;
            color: var(--mint);
            font-weight: 300;
            letter-spacing: 1px;
            animation: slideDown 0.6s ease-out 0.3s both;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Countdown Section */
        .countdown-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(26, 58, 46, 0.4);
            border-radius: 16px;
            border: 1px solid rgba(201, 169, 97, 0.2);
            text-align: center;
            animation: slideDown 0.6s ease-out 0.35s both;
        }

        .countdown-label {
            font-size: 0.9rem;
            color: var(--mint);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 0.5rem;
            font-weight: 300;
        }

        .next-prayer-name {
            font-size: 1.3rem;
            color: var(--gold);
            font-weight: 600;
            margin-bottom: 0.8rem;
        }

        .countdown-timer {
            font-size: 2.5rem;
            color: var(--cream);
            font-variant-numeric: tabular-nums;
            letter-spacing: 2px;
            font-weight: 300;
        }

        /* Progress Bar */
        .progress-section {
            margin-bottom: 2rem;
            animation: slideDown 0.6s ease-out 0.4s both;
        }

        .progress-label {
            font-size: 0.85rem;
            color: var(--mint);
            text-align: center;
            margin-bottom: 0.8rem;
            letter-spacing: 1px;
        }

        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: rgba(26, 58, 46, 0.5);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(201, 169, 97, 0.15);
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--gold), var(--mint));
            border-radius: 10px;
            transition: width 1s ease-out;
            box-shadow: 0 0 10px rgba(201, 169, 97, 0.3);
        }

        .section-title {
            font-size: 0.9rem;
            color: var(--mint);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 1rem;
            text-align: center;
            font-weight: 300;
        }

        .prayer-times {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .prayer-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.2rem 1.5rem;
            background: rgba(26, 58, 46, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(201, 169, 97, 0.15);
            transition: all 0.3s ease;
            animation: slideUp 0.5s ease-out both;
            position: relative;
            overflow: hidden;
        }

        .prayer-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--gold);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .prayer-item.current {
            background: var(--highlight);
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(201, 169, 97, 0.2);
        }

        .prayer-item.current::before {
            transform: scaleY(1);
        }

        .prayer-item.passed {
            opacity: 0.5;
        }

        .prayer-item:nth-child(1) { animation-delay: 0.5s; }
        .prayer-item:nth-child(2) { animation-delay: 0.6s; }
        .prayer-item:nth-child(3) { animation-delay: 0.7s; }
        .prayer-item:nth-child(4) { animation-delay: 0.8s; }
        .prayer-item:nth-child(5) { animation-delay: 0.9s; }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .prayer-item:hover {
            background: rgba(26, 58, 46, 0.5);
            border-color: rgba(201, 169, 97, 0.3);
            transform: translateX(4px);
        }

        .prayer-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--cream);
            letter-spacing: 0.5px;
        }

        .prayer-item.current .prayer-name {
            color: var(--gold);
        }

        .prayer-time {
            font-size: 1.3rem;
            font-weight: 300;
            color: var(--gold);
            font-variant-numeric: tabular-nums;
            letter-spacing: 1px;
        }

        .prayer-item.current .prayer-time {
            font-weight: 600;
        }

        /* Tomorrow's Section */
        .tomorrow-section {
            margin-top: 2.5rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(201, 169, 97, 0.2);
            animation: slideUp 0.6s ease-out 1s both;
        }

        .tomorrow-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .tomorrow-title {
            font-size: 0.9rem;
            color: var(--mint);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 0.5rem;
            font-weight: 300;
        }

        .tomorrow-date {
            font-family: 'Amiri', serif;
            font-size: 1.5rem;
            color: var(--gold);
            font-weight: 600;
        }

        .tomorrow-gregorian {
            font-size: 0.95rem;
            color: var(--mint);
            margin-top: 0.3rem;
        }

        .tomorrow-prayers {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .tomorrow-prayer-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.3rem;
            background: rgba(26, 58, 46, 0.25);
            border-radius: 10px;
            border: 1px solid rgba(201, 169, 97, 0.12);
            transition: all 0.3s ease;
        }

        .tomorrow-prayer-item:hover {
            background: rgba(26, 58, 46, 0.4);
            border-color: rgba(201, 169, 97, 0.25);
        }

        .ornament {
            text-align: center;
            margin: 2rem 0 1rem;
            color: var(--gold);
            opacity: 0.4;
            font-size: 1.5rem;
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--mint);
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .no-data-today {
            text-align: center;
            padding: 1.5rem;
            background: rgba(26, 58, 46, 0.2);
            border-radius: 12px;
            border: 1px solid rgba(201, 169, 97, 0.15);
            color: var(--mint);
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 2rem;
        }

        @media (max-width: 600px) {
            .container {
                padding: 2rem 1.5rem;
            }

            .arabic-date {
                font-size: 1.8rem;
            }

            .countdown-timer {
                font-size: 2rem;
            }

            .prayer-item {
                padding: 1rem 1.2rem;
            }

            .prayer-name {
                font-size: 1rem;
            }

            .prayer-time {
                font-size: 1.1rem;
            }

            .tomorrow-date {
                font-size: 1.3rem;
            }
        }

        /* Decorative background elements */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(201, 169, 97, 0.03) 1px, transparent 1px);
            background-size: 40px 40px;
            animation: drift 60s linear infinite;
            pointer-events: none;
        }

        @keyframes drift {
            from {
                transform: translate(0, 0);
            }
            to {
                transform: translate(40px, 40px);
            }
        }

        /* Pulse animation for current prayer */
        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 20px rgba(201, 169, 97, 0.2);
            }
            50% {
                box-shadow: 0 0 30px rgba(201, 169, 97, 0.4);
            }
        }

        .prayer-item.current {
            animation: pulse 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div class="container" id="app">
        <div class="header">
            <div class="arabic-date" id="arabic-date">رمضان</div>
            <div class="gregorian-date" id="gregorian-date">Chargement...</div>
        </div>

        <div id="today-content">
            <div class="countdown-section" id="countdown-section" style="display: none;">
                <div class="countdown-label">Prochaine prière</div>
                <div class="next-prayer-name" id="next-prayer-name">Fajr</div>
                <div class="countdown-timer" id="countdown-timer">00:00:00</div>
            </div>

            <div class="progress-section" id="progress-section" style="display: none;">
                <div class="progress-label" id="progress-label">Progression du jour</div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
                </div>
            </div>

            <div id="no-data-message" style="display: none;"></div>

            <div class="prayer-times" id="prayer-times">
                <!-- Prayer times will be inserted here -->
            </div>
        </div>

        <div class="tomorrow-section" id="tomorrow-section" style="display: none;">
            <div class="tomorrow-header">
                <div class="tomorrow-title">Demain matin</div>
                <div class="tomorrow-date" id="tomorrow-date"></div>
                <div class="tomorrow-gregorian" id="tomorrow-gregorian"></div>
            </div>
            <div class="tomorrow-prayers" id="tomorrow-prayers">
                <!-- Tomorrow's Imsak and Fajr will be inserted here -->
            </div>
        </div>

        <div class="ornament">۞</div>
    </div>

    <script>
        // Arabic month names
        const arabicMonths = {
            'Ramadan': 'رمضان',
            'Shawwal': 'شوال',
            'Dhul-Qadah': 'ذو القعدة',
            'Dhul-Hijjah': 'ذو الحجة'
        };

        // Month name mapping from French to English for date matching
        const monthMapping = {
            'Janvier': 0, 'Février': 1, 'Mars': 2, 'Avril': 3,
            'Mai': 4, 'Juin': 5, 'Juillet': 6, 'Août': 7,
            'Septembre': 8, 'Octobre': 9, 'Novembre': 10, 'Décembre': 11
        };

        // CSV data
        const csvData = `Hegerian day;Hegerian month;Gregorian day;Gregorian month;Imsak;Fajr;Shuruq;Maghrib (+);Isha (15);;;
1;Ramadan;19;Février;06:03;06:22;07:52;18:18;19:42;;;
2;Ramadan;20;Février;06:01;06:20;07:50;18:20;19:44;;;
3;Ramadan;21;Février;05:59;06:18;07:48;18:21;19:46;;;
4;Ramadan;22;Février;05:57;06:16;07:46;18:23;19:47;;;
5;Ramadan;23;Février;05:55;06:14;07:44;18:25;19:49;;;
6;Ramadan;24;Février;05:53;06:12;07:42;18:27;19:51;;;
7;Ramadan;25;Février;05:51;06:11;07:40;18:28;19:52;;;
8;Ramadan;26;Février;05:49;06:09;07:38;18:30;19:54;;;
9;Ramadan;27;Février;05:47;06:07;07:36;18:32;19:56;;;
10;Ramadan;28;Février;05:45;06:05;07:34;18:33;19:57;;;
11;Ramadan;1;Mars;05:43;06:02;07:32;18:35;19:59;;;
12;Ramadan;2;Mars;05:41;06:00;07:30;18:37;20:01;;;
13;Ramadan;3;Mars;05:39;05:58;07:28;18:39;20:02;;;
14;Ramadan;4;Mars;05:37;05:56;07:26;18:40;20:04;;;
15;Ramadan;5;Mars;05:35;05:54;07:24;18:42;20:06;;;
16;Ramadan;6;Mars;05:33;05:52;07:22;18:44;20:07;;;
17;Ramadan;7;Mars;05:30;05:50;07:19;18:45;20:09;;;
18;Ramadan;8;Mars;05:28;05:48;07:17;18:47;20:11;;;
19;Ramadan;9;Mars;05:26;05:45;07:15;18:49;20:12;;;
20;Ramadan;10;Mars;05:24;05:43;07:13;18:50;20:14;;;
21;Ramadan;11;Mars;05:21;05:41;07:11;18:52;20:16;;;
22;Ramadan;12;Mars;05:19;05:39;07:08;18:54;20:18;;;
23;Ramadan;13;Mars;05:17;05:36;07:06;18:55;20:19;;;
24;Ramadan;14;Mars;05:14;05:34;07:04;18:57;20:21;;;
25;Ramadan;15;Mars;05:12;05:32;07:02;18:59;20:23;;;
26;Ramadan;16;Mars;05:10;05:29;07:00;19:00;20:25;;;
27;Ramadan;17;Mars;05:07;05:27;06:57;19:02;20:26;;;
28;Ramadan;18;Mars;05:05;05:25;06:55;19:03;20:28;;;
29;Ramadan;19;Mars;05:02;05:22;06:53;19:05;20:30;;;
30;Ramadan;20;Mars;05:00;05:20;06:51;19:07;20:32;;;`;

        let currentPrayerData = null;
        let updateInterval = null;

        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(';');
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(';');
                const row = {};
                headers.forEach((header, index) => {
                    row[header.trim()] = values[index]?.trim() || '';
                });
                data.push(row);
            }

            return data;
        }

        function findPrayerTimesByDate(day, month) {
            const prayerData = parseCSV(csvData);

            for (const row of prayerData) {
                const gregorianDay = parseInt(row['Gregorian day']);
                const gregorianMonth = monthMapping[row['Gregorian month']];

                if (gregorianDay === day && gregorianMonth === month) {
                    return row;
                }
            }

            return null;
        }

        function findTodaysPrayerTimes() {
            const today = new Date();
            return findPrayerTimesByDate(today.getDate(), today.getMonth());
        }

        function findTomorrowsPrayerTimes() {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            return findPrayerTimesByDate(tomorrow.getDate(), tomorrow.getMonth());
        }

        function timeToMinutes(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }

        function getCurrentTimeInMinutes() {
            const now = new Date();
            return now.getHours() * 60 + now.getMinutes();
        }

        function findCurrentAndNextPrayer(prayers) {
            const currentTime = getCurrentTimeInMinutes();
            let currentPrayer = null;
            let nextPrayer = null;

            for (let i = 0; i < prayers.length; i++) {
                const prayerTime = timeToMinutes(prayers[i].time);
                
                if (currentTime >= prayerTime) {
                    currentPrayer = i;
                } else if (currentTime < prayerTime && nextPrayer === null) {
                    nextPrayer = i;
                    break;
                }
            }

            if (nextPrayer === null) {
                nextPrayer = 0;
            }

            return { currentPrayer, nextPrayer };
        }

        function formatCountdown(minutes) {
            const hours = Math.floor(minutes / 60);
            const mins = Math.floor(minutes % 60);
            const secs = Math.floor((minutes * 60) % 60);
            
            return `${String(hours).padStart(2, '0')}:${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        function updateCountdown(prayers, nextPrayerIndex) {
            const now = new Date();
            const currentMinutes = now.getHours() * 60 + now.getMinutes() + now.getSeconds() / 60;
            
            let nextPrayerTime = timeToMinutes(prayers[nextPrayerIndex].time);
            
            if (nextPrayerTime < currentMinutes) {
                nextPrayerTime += 24 * 60;
            }
            
            const difference = nextPrayerTime - currentMinutes;
            
            document.getElementById('countdown-timer').textContent = formatCountdown(difference);
            document.getElementById('next-prayer-name').textContent = prayers[nextPrayerIndex].name;
        }

        function updateProgressBar(prayers, currentPrayerIndex, nextPrayerIndex) {
            if (currentPrayerIndex === null) {
                const firstPrayerTime = timeToMinutes(prayers[0].time);
                const currentTime = getCurrentTimeInMinutes();
                const dayStart = 0;
                const progress = ((currentTime - dayStart) / (firstPrayerTime - dayStart)) * 100;
                
                document.getElementById('progress-bar').style.width = Math.min(progress, 100) + '%';
                document.getElementById('progress-label').textContent = `Avant ${prayers[0].name}`;
            } else if (currentPrayerIndex === prayers.length - 1) {
                document.getElementById('progress-bar').style.width = '100%';
                document.getElementById('progress-label').textContent = `Après ${prayers[prayers.length - 1].name}`;
            } else {
                const currentPrayerTime = timeToMinutes(prayers[currentPrayerIndex].time);
                const nextPrayerTime = timeToMinutes(prayers[nextPrayerIndex].time);
                const currentTime = getCurrentTimeInMinutes();
                
                const progress = ((currentTime - currentPrayerTime) / (nextPrayerTime - currentPrayerTime)) * 100;
                
                document.getElementById('progress-bar').style.width = Math.min(Math.max(progress, 0), 100) + '%';
                document.getElementById('progress-label').textContent = `${prayers[currentPrayerIndex].name} → ${prayers[nextPrayerIndex].name}`;
            }
        }

        function displayTomorrowsPrayers() {
            const tomorrowData = findTomorrowsPrayerTimes();
            const tomorrowSection = document.getElementById('tomorrow-section');
            
            if (!tomorrowData) {
                tomorrowSection.style.display = 'none';
                return;
            }

            const hegerianMonth = tomorrowData['Hegerian month'];
            const arabicMonth = arabicMonths[hegerianMonth] || hegerianMonth;
            
            document.getElementById('tomorrow-date').textContent = `${tomorrowData['Hegerian day']} ${arabicMonth}`;
            document.getElementById('tomorrow-gregorian').textContent = `${tomorrowData['Gregorian day']} ${tomorrowData['Gregorian month']}`;

            const tomorrowPrayers = [
                { name: 'Imsak', time: tomorrowData['Imsak'] },
                { name: 'Fajr', time: tomorrowData['Fajr'] }
            ];

            document.getElementById('tomorrow-prayers').innerHTML = tomorrowPrayers
                .map(prayer => `
                    <div class="tomorrow-prayer-item">
                        <div class="prayer-name">${prayer.name}</div>
                        <div class="prayer-time">${prayer.time}</div>
                    </div>
                `)
                .join('');

            tomorrowSection.style.display = 'block';
        }

        function displayPrayerTimes() {
            const data = findTodaysPrayerTimes();
            const arabicDateEl = document.getElementById('arabic-date');
            const gregorianDateEl = document.getElementById('gregorian-date');
            const prayerTimesEl = document.getElementById('prayer-times');
            const countdownSection = document.getElementById('countdown-section');
            const progressSection = document.getElementById('progress-section');
            const noDataMessage = document.getElementById('no-data-message');

            const today = new Date();
            gregorianDateEl.textContent = today.toLocaleDateString('fr-FR', { 
                day: 'numeric', 
                month: 'long',
                year: 'numeric'
            });

            if (!data) {
                // No data for today, but show tomorrow's Fajr/Imsak
                arabicDateEl.textContent = 'رمضان';
                prayerTimesEl.innerHTML = '';
                countdownSection.style.display = 'none';
                progressSection.style.display = 'none';
                noDataMessage.style.display = 'block';
                noDataMessage.className = 'no-data-today';
                noDataMessage.innerHTML = `Aucune donnée disponible pour aujourd'hui.<br>Consultez les horaires de demain ci-dessous.`;
                
                displayTomorrowsPrayers();
                return;
            }

            noDataMessage.style.display = 'none';
            currentPrayerData = data;

            // Display dates
            const hegerianMonth = data['Hegerian month'];
            const arabicMonth = arabicMonths[hegerianMonth] || hegerianMonth;
            arabicDateEl.textContent = `${data['Hegerian day']} ${arabicMonth}`;

            // Prepare prayer times
            const prayers = [
                { name: 'Imsak', time: data['Imsak'] },
                { name: 'Fajr', time: data['Fajr'] },
                { name: 'Shuruq', time: data['Shuruq'] },
                { name: 'Maghrib', time: data['Maghrib (+)'] },
                { name: 'Isha', time: data['Isha (15)'] }
            ];

            // Find current and next prayer
            const { currentPrayer, nextPrayer } = findCurrentAndNextPrayer(prayers);

            // Display prayer times with indicators
            prayerTimesEl.innerHTML = prayers
                .map((prayer, index) => {
                    let classes = 'prayer-item';
                    const prayerTime = timeToMinutes(prayer.time);
                    const currentTime = getCurrentTimeInMinutes();
                    
                    if (index === currentPrayer) {
                        classes += ' current';
                    } else if (prayerTime < currentTime) {
                        classes += ' passed';
                    }
                    
                    return `
                        <div class="${classes}">
                            <div class="prayer-name">${prayer.name}</div>
                            <div class="prayer-time">${prayer.time}</div>
                        </div>
                    `;
                })
                .join('');

            // Show and update countdown
            countdownSection.style.display = 'block';
            progressSection.style.display = 'block';
            
            updateCountdown(prayers, nextPrayer);
            updateProgressBar(prayers, currentPrayer, nextPrayer);

            // Update every second
            if (updateInterval) clearInterval(updateInterval);
            updateInterval = setInterval(() => {
                const { currentPrayer: cp, nextPrayer: np } = findCurrentAndNextPrayer(prayers);
                updateCountdown(prayers, np);
                updateProgressBar(prayers, cp, np);
                
                const newCurrentTime = getCurrentTimeInMinutes();
                const oldCurrentPrayer = currentPrayer;
                if (cp !== oldCurrentPrayer) {
                    displayPrayerTimes();
                }
            }, 1000);

            // Display tomorrow's prayers
            displayTomorrowsPrayers();
        }

        // Initialize on page load
        displayPrayerTimes();
    </script>
</body>
</html>
